"use strict";(self.webpackChunksystem=self.webpackChunksystem||[]).push([[7037],{51881:function(e,t){t.Z={name:"",key:"",policy:"eyJleHBpcmF0aW9uIjoiMzAyMi0wMS0wMVQxMjowMDowMC4wMDBaIiwiY29uZGl0aW9ucyI6W1siY29udGVudC1sZW5ndGgtcmFuZ2UiLDAsMTA0ODU3NjAwMF1dfQ==",OSSAccessKeyId:"LTAI5t7u1jzmji9stQ5LzCpe",success_action_status:"200",signature:"tF/dwb/qvoQjHffu0kq5FWQq9KY="}},38954:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var l=a(73396),n=a(44870),r=a(87139),d=a(44385),o=a(6094),i=a(83762),s=a(12862),u=(a(57658),a(81081));class c extends a(20566).Z{constructor({modules:e="",selectUri:t="/",deleteUri:a="/",selectOneUri:l="/",pageSize:n=20,tableHeader:r}={}){super({modules:e,selectUri:t,deleteUri:a,selectOneUri:l,pageSize:n,tableHeader:r})}forMatData(e,t){switch(e){case"sex":return+t?"女":"男";case"status":return+t?"停用":"正常";case"avatar":return"点击浏览";default:return t&&0<t.toString().length||"number"==typeof t?t:"-"}}createTreeData(e){let t=[];return e.forEach((a=>{var l;a.label=a.deptName,a.value=a.deptId,t.push((l=a,e.forEach((e=>{e.parentId===l.deptId&&l.children.push(e)})),l))})),t[0]}async initData(e=this,t){var{data:a,code:l}=(await u.K.post(`${e.selectUri}?pageNum=${e.currentPage}&pageSize=`+e.pageSize,e.searchData))["data"];200===l&&0!==a.length&&(e.total=a.length,e.tableData.length=0,e.tableData.push(e.createTreeData(a)),t?.clearSelection())}async updateDept(e){var{code:e,data:t,msg:a}=(await u.K.put("/system/dept",e))["data"];return 200===e?{code:e,data:t}:a}async getDept(e){var{code:e,data:t,msg:a}=(await u.K.get("/system/dept/"+e))["data"];return 200===e?{code:e,data:t}:a}async addDept(e){var{code:e,data:t,msg:a}=(await u.K.post("/system/dept",e))["data"];return 200===e?{code:e,data:t}:a}async deleteDept(e){var{code:e,data:t,msg:a}=(await u.K.delete("/system/dept/"+e))["data"];return 200===e?{code:e,data:t}:a}}var m=a(82261),p=a(59971),f=a(51881);const h={class:"data-filter"},g={class:"extend-handle"},v={class:"extend-handle-left"},y=["id"];t={__name:"departmentManagement",setup(e){const t=(0,l.Q2)("authority"),a=(0,n.iH)(f.Z),w=(0,l.FN)()["proxy"],b=(0,n.iH)(!1),S=(0,n.iH)(null),k=()=>{S.value=new c({modules:"depart",selectUri:"/system/dept/list"}),S.value.initTableHeader(),S.value.initData(this,w.$refs.table)},D=((0,l.wF)((()=>{k()})),async({deptId:e})=>{T.formSelectEl[0].options=[...S.value.tableData],e=await S.value.getDept(e),I.value={...e.data},0===I.value.parentId?(T.formSelectEl[0].options.unshift({label:"顶级部门",value:0,children:[]}),T.formSelectEl[0].disabled=!0):T.formSelectEl[0].disabled=!1,T.isShow=!0}),U=async()=>{T.formSelectEl[0].options=[...S.value.tableData],T.formSelectEl[0].disabled=!1,I.value={status:"0",parentId:100,orderNum:0},T.isShow=!0},E=async({deptId:e})=>{T.formSelectEl[0].options=[...S.value.tableData],I.value={status:"0",parentId:e,orderNum:0},T.isShow=!0},_=e=>{S.value.search(e,this,w.$refs.table)},C=e=>(e.parentId,[(0,l.h)("div",{class:"table-handel-div"},[(0,l.wy)((0,l.h)(m.ElButton,{class:"hover-animation",onClick:()=>{D(e)},title:"编辑",type:"primary",icon:"Edit",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>""}),[[t,"system:dept:edit"]]),(0,l.wy)((0,l.h)(m.ElButton,{class:"hover-animation",onClick:()=>{E(e)},title:"新增下级部门",type:"warning",icon:"CirclePlus",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>""}),[[t,"system:dept:edit"]])])]),I=(0,n.iH)({}),T=(0,n.qj)({isShow:!1,formInputEl:[{title:"部门名称",key:"deptName",element:"input"},{title:"部门负责人",key:"leader",element:"input",type:"dialog",canInput:!0},{title:"负责人联系电话",key:"phone",element:"input"},{title:"邮箱",key:"email",element:"input"}],formSelectEl:[{title:"所属上级部门",key:"parentId",element:"selectTree",options:[],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"部门状态",key:"status",element:"radio",options:[{label:"正常",value:"0"},{label:"停用",value:"1"}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}],formTimeAndNumber:[{title:"显示顺序",key:"orderNum",element:"number"}],formTextAreaEl:[{title:"备注",key:"remark",element:"input",type:"textarea"}],emitOpenDialog:e=>{},inputDone:async e=>{e={...e},e.deptId?200===(await S.value.updateDept(e)).code&&(w.$message.success("更新成功"),S.value.initData(this,w.$refs.table),T.isShow=!1):200===(await S.value.addDept(e)).code&&(w.$message.success("新增成功"),S.value.initData(this,w.$refs.table),T.isShow=!1)}}),x=({forMatValue:e,column:t,rowData:a})=>"status"===t.key?[(0,l.h)(p.Ks,{type:"0"===a[t.key]?"":"danger"},{default:()=>e})]:e,H=()=>{w.$refs.table.closeTree()};return(e,t)=>{const c=(0,l.up)("CircleCloseFilled"),p=(0,l.up)("el-icon");var f=(0,l.up)("el-drawer"),k=(0,l.Q2)("authorityHandle");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",h,[(0,l.Wm)(s.Z,{"filter-items":S.value.tableHeader,onSearch:_},null,8,["filter-items"])]),(0,l._)("div",g,[(0,l._)("div",v,[(0,l.Wm)((0,n.SU)(m.ElButton),{class:"handle-btn",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:H},{default:(0,l.w5)((()=>[(0,l.Uk)(" 全部折叠 ")])),_:1}),(0,l.wy)(((0,l.wg)(),(0,l.j4)((0,n.SU)(m.ElButton),{class:"handle-btn",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:U},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增 ")])),_:1})),[[k,"system:dept:add"]])])]),(0,l.Wm)(i.Z,{ref:"table","need-end-handle":"","need-check-box":!1,"need-customize-cell-renderer":"","need-expand":"","row-key":"deptName","need-pagination":!1,total:S.value.total,"current-page":S.value.currentPage,"page-size":S.value.pageSize,"table-data":S.value.tableData,columns:S.value.tableHeader,loading:(0,n.SU)(u.V)&&!T.isShow,"default-end-handle":!1,"customize-end-handle":C,"for-mat-data":S.value.forMatData,"customize-cell-renderer":x,"end-handle-width":140,onSelectionChange:t[0]||(t[0]=e=>S.value.selectionChange(e,S.value,(0,n.SU)(w).$refs.table)),onRefresh:t[1]||(t[1]=e=>S.value.initData(S.value,(0,n.SU)(w).$refs.table)),onEditRow:D,onCurrentChange:t[2]||(t[2]=e=>S.value.currentPageChange(e,S.value,(0,n.SU)(w).$refs.table)),onSizeChange:t[3]||(t[3]=e=>S.value.pageSizeChange(e,S.value,(0,n.SU)(w).$refs.table)),onEditTableHeader:t[4]||(t[4]=e=>b.value=!0)},null,8,["total","current-page","page-size","table-data","columns","loading","for-mat-data"]),(0,l.Wm)(f,{modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e),"show-close":!1},{header:(0,l.w5)((({titleId:e,titleClass:a})=>[(0,l._)("h4",{id:e,class:(0,r.C_)(a)}," 通过拖拽设置您喜欢的表头顺序 ",10,y),(0,l.Wm)((0,n.SU)(m.ElButton),{type:"danger",onClick:t[5]||(t[5]=e=>b.value=!1)},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{class:"el-icon--left"},{default:(0,l.w5)((()=>[(0,l.Wm)(c)])),_:1}),(0,l.Uk)(" 关闭 ")])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(o.Z,{"is-show-edit-table-header":b.value,modules:"depart"},null,8,["is-show-edit-table-header"])])])),_:1},8,["modelValue"]),T.isShow?((0,l.wg)(),(0,l.j4)(d.Z,{key:0,ref:"dialogForm",width:"60%",loading:(0,n.SU)(u.V),"my-client":a.value,"form-data":I.value,"is-show":T.isShow,title:"请填写相关信息","form-input-el":T.formInputEl,"form-select-el":T.formSelectEl,"form-text-area-el":T.formTextAreaEl,"form-upload-el":T.formUploadEl,"form-time-and-number":T.formTimeAndNumber,onCloseDialog:t[7]||(t[7]=e=>T.isShow=!1),onEmitOpenDialog:T.emitOpenDialog,onInputDone:T.inputDone},null,8,["loading","my-client","form-data","is-show","form-input-el","form-select-el","form-text-area-el","form-upload-el","form-time-and-number","onEmitOpenDialog","onInputDone"])):(0,l.kq)("",!0)])}}};var w=(0,a(40089).Z)(t,[["__scopeId","data-v-6a208d3f"]])},6094:function(e,t,a){a.d(t,{Z:function(){return p}}),a(57658);var l=a(73396),n=a(44870),r=a(49242),d=a(87139),o=a(98249),i=a(40130),s=a(46623);const u={class:"container"},c={class:"drag-box"},m={class:"drag-btn"};t={__name:"dynamicHeader",props:{isShowEditTableHeader:{type:Boolean,default:!1},modules:{type:String,default:""},filterList:{type:Array,default:()=>[]}},emits:["updateCompleted"],setup(e,{emit:t}){const a=e,{_state:p,commit:f}=(0,s.oR)(),h=p.data[a.modules].defaultTableHeader,g=(0,n.qj)([]),v=(0,n.iH)(!1),y=((0,l.wF)((()=>{(g.length=0)===a.filterList.length?g.push(...p.data[a.modules].tableHeader):p.data[a.modules].tableHeader.forEach((e=>{a.filterList.includes(e.key)||g.push(e)}))})),e=>{v.value=!1}),w=()=>{i.T.confirm("重置之后保存的数据将会丢失，是否继续？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{g.length=0,g.push(...JSON.parse(JSON.stringify(h))),f(a.modules+"/updateTableHeader",g),i.T.alert("修改成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{t("updateCompleted"),location.reload()}}),t("updateCompleted")})).catch((()=>{}))},b=()=>{i.T.confirm("确认保存？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{0!==a.filterList.length&&p.data[a.modules].tableHeader.forEach((e=>{a.filterList.includes(e.key)&&g.push(e)})),f(a.modules+"/updateTableHeader",g),i.T.alert("设置成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{t("updateCompleted"),location.reload()}})})).catch((()=>{}))};return(e,t)=>{const a=(0,l.up)("el-tag"),i=(0,l.up)("el-checkbox");var s=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("div",c,[(0,l.Wm)((0,n.SU)(o.J),{list:g,"chosen-class":"chosen",group:"name","force-fallback":"true",animation:"500","fallback-tolerance":4,onStart:t[0]||(t[0]=e=>v.value=!0),onEnd:y},{default:(0,l.w5)((()=>[(0,l.Wm)(r.W3,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.key||e.prop,class:"item"},[(0,l.Wm)(a,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.title||e.label),1)])),_:2},1024),(0,l._)("div",null,[(0,l.Wm)(i,{modelValue:e.isFixed,"onUpdate:modelValue":t=>e.isFixed=t,label:"固定在左边",size:"large"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(i,{modelValue:e.isShow,"onUpdate:modelValue":t=>e.isShow=t,label:"是否展示",size:"large"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])),_:1})])),_:1},8,["list"])]),(0,l._)("div",m,[(0,l.Wm)(s,{type:"warning",onClick:w},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1}),(0,l.Wm)(s,{type:"primary",onClick:b},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1})])])}}};var p=(0,a(40089).Z)(t,[["__scopeId","data-v-4c5f22fa"]])}}]);