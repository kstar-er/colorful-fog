"use strict";(self.webpackChunksystem=self.webpackChunksystem||[]).push([[8160],{83762:function(e,t,a){a.d(t,{Z:function(){return w}}),a(57658);var l=a(49242),n=a(73396),d=a(87139),o=a(44870),r=a(72748),i=a(20319),u=a(61745),c=a(82261),s=a(68521),v=a(22483);const h=(e=>((0,n.dD)("data-v-ebadeb7c"),e=e(),(0,n.Cn)(),e))((()=>(0,n._)("div",{class:"empty"},[(0,n._)("span",{class:"label"},"数据消失在茫茫人海中...")],-1))),y={class:"el-loading-mask flex-center",style:{"flex-direction":"column",background:"rgba(255,255,255,.6)"}},p={class:"mt20",style:{color:"var(--el-color-primary)","font-size":"16px"}},f={class:"page"},m={class:"contextmenu-content"},g={class:"list"};t={__name:"virtualTable",props:{loading:{type:Boolean,default:!1},rowKey:{type:String,default:"id"},loadPrompt:{type:String,default:""},cache:{type:Number,default:6},columns:{type:Array,default:()=>[]},tableData:{type:Array,default:()=>[]},needCheckBox:{type:Boolean,default:!1},checkAll:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},needEndHandle:{type:Boolean,default:!1},needChangeSize:{type:Boolean,default:!0},total:{type:Number,default:0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:1},cellHandle:{type:Object,default:()=>({})},cellHandleFun:{type:Function,default:()=>""},needCustomizeCellRenderer:{type:Boolean,default:!1},customizeCellRenderer:{type:Function,default:(e,t,a,l,n)=>{}},needFixedCheckData:{type:Boolean,default:!1},needDynamicEditingHeader:{type:Boolean,default:!0},forMatData:{type:Function,default:(e,t)=>e&&t&&(-1!==e.indexOf("Time")||-1!==e.indexOf("Date"))?(new s.x).timeStamp2Time(t,"yyyy-MM-dd hh:mm:ss"):t??"-"},rowClass:{type:Function,default:({rowData:{checked:e},rowIndex:t})=>e?"checked-light-row":t%2==0?"stripe":""},autoWidth:{type:Number,default:0},endHandleWidth:{type:Number,default:160},defaultEndHandle:{type:Boolean,default:!0},customizeEndHandle:{type:Function,default:e=>[(0,n.h)("div",{class:"table-handel-div no-options"},"暂无操作")]},row:{type:Function,default:({cells:e})=>e},needExpand:{type:Boolean,default:!1},estimatedRowHeight:{type:Number},needPagination:{type:Boolean,default:!0},useUpdateHeader:{type:Boolean,default:!0}},emits:["save","refresh","editRow","deleteRow","selectionChange","sizeChange","currentChange","editTableHeader","selectionChangeRow"],setup(e,{expose:t,emit:a}){const s=e,w=((0,l.sj)((e=>({"38570ca6":Q.value,f1e065d6:x.value}))),(0,n.FN)())["proxy"],b=(0,v.tv)(),x=(0,o.iH)("#3d84be"),k=(0,o.iH)([]);let C=(0,o.iH)(s.tableData);const H=(0,o.iH)(s.showFooter?window.screen.height-460-50:window.screen.height-460),S=(0,o.iH)(s.pageSize),E=(0,o.iH)(s.currentPage),_=e=>a("currentChange",e),D=e=>a("sizeChange",e),z=(0,o.iH)(!1),M=(0,o.iH)(!1),R=(0,o.iH)("right"),F=(0,o.iH)(-1),K=(0,o.iH)(-1),B=(0,o.iH)(0),L=(0,o.iH)(0),T=(0,o.iH)(-1),q=(0,o.iH)(-1),I=(0,o.iH)(!1),P=(0,o.iH)(!1),$=(0,o.iH)([]),N=(0,o.iH)(s.columns),U=(0,o.iH)(null),A=(0,o.iH)(0),V=(0,o.iH)(s.row);!function(){let e=0;N.value.forEach((t=>{t.canMove=!1,t.align="left",t.dataType=t.dataType,t.fixed=t.isFixed?i.V7.LEFT:"",t.key=t.key||t.prop,t.dataKey=t.key,t.title=t.title||t.label,t.headerCellRenderer=s.needDynamicEditingHeader?({column:a})=>[(0,n.h)("div",{class:`header-cell-${t.dataKey} header-cell`,title:t.title},t.title,[(0,n.h)("div",{class:"sort-icon-div"},[(0,n.h)(r.SortDown,{class:"sort-icon",onClick:W.bind(this,[t.dataKey,"down"])}),(0,n.h)(r.SortUp,{class:"sort-icon",onClick:W.bind(this,[t.dataKey,"up"])})]),(0,n.h)("div",{onMousedown:l=>{if(!s.needExpand){e=l.clientX,l=document.querySelectorAll(".el-table-v2__header-row");let n=document.querySelector(".header-border-"+t.dataKey);l[0].style.cursor="e-resize",l[1].style.cursor="e-resize",a.canMove=!0,l[0]?.addEventListener("mousemove",(t=>{a.canMove&&(n.style.left=a.width-15+(t.clientX-e)+"px")})),l[1]?.addEventListener("mousemove",(t=>{a.canMove&&(n.style.left=a.width-15+(t.clientX-e)+"px")})),l[0]?.addEventListener("mouseup",(l=>{var n=document.querySelector(".header-border-"+t.dataKey),d=document.querySelectorAll(".el-table-v2__header-row");d[0].style.cursor="default",d[1].style.cursor="default",0<+n.style.left.replace("px","")+15?(a.width=+n.style.left.replace("px","")+15,a.canMove=!1,e=0):n.style.left=a.width-15})),l[1]?.addEventListener("mouseup",(l=>{var n=document.querySelector(".header-border-"+t.dataKey),d=document.querySelectorAll(".el-table-v2__header-row");d[0].style.cursor="default",d[1].style.cursor="default",0<+n.style.left.replace("px","")+15?(a.width=+n.style.left.replace("px","")+15,a.canMove=!1,e=0):n.style.left=a.width-15}))}},class:`header-border-${t.dataKey} header-border`,style:`left:${t.width-15}px;top:-14px`})])]:()=>[(0,n.h)("div",{class:`header-cell-${t.dataKey} header-cell`,title:t.title},t.title)],t.cellRenderer=({rowData:e,column:t,rowIndex:a})=>{var l=s.forMatData(t.dataKey,e[t.dataKey],e,t);return O({rowData:e,rowIndex:a,column:t,forMatValue:l})}}))}();const W=([e,t])=>{C.value.sort(((a,l)=>a[e]<l[e]?"up"===t?-1:1:a[e]>l[e]?"up"===t?1:-1:0))},O=({forMatValue:e,rowIndex:t,column:a,rowData:l})=>{var d=JSON.parse(localStorage.getItem("userSettings"));let o="";d&&(o=`color:${d.tableSetting.color};font-size:${d.tableSetting.fontSize}px`);d=a.prop||a.key;var r=s.cellHandle.hasOwnProperty(d)?s.cellHandle[d].class:"",i=s.cellHandleFun({key:d,rowData:l});return[(0,n.h)("div",{class:`row-cell ${r} `+i,title:e,style:0!==o.length?o:"",onMouseenter:e=>{if(!s.needExpand&&z.value&&M.value){$.value.length=0,T.value=T.value<t?T.value:t,q.value=T.value<t?t:T.value;for(let e=T.value;e<=q.value;e++)C.value[e].checked=!0;I.value=C.value.every((e=>e.checked)),P.value=C.value.some((e=>e.checked));var a=C.value.filter((e=>e.checked));$.value=a}},onmousedown:e=>{var a;s.needExpand||(M.value&&(C.value[t].checked=!C.value[t].checked,I.value=C.value.every((e=>e.checked)),P.value=C.value.some((e=>e.checked)),a=C.value.filter((e=>e.checked)),$.value=a,F.value=e.x,K.value=e.y),T.value=t,z.value=!0)},onselectstart:()=>{if(M.value)return!1},onClick:s.cellHandle.hasOwnProperty(d)&&s.cellHandle[d].onClick?s.cellHandle[d].onClick.bind(this,l):()=>{}},s.needCustomizeCellRenderer?s.customizeCellRenderer({forMatValue:e,rowIndex:t,column:a,rowData:l}):e)]},X=function(){N.value.unshift({key:"selection",width:50,align:"center",fixed:s.needFixedCheckData?"":i.V7.LEFT,cellRenderer:({rowData:e})=>[(0,n.h)(u.ElCheckbox,{onChange:t=>{var l=(0,o.SU)(C);e.checked=t,I.value=l.every((e=>e.checked)),P.value=l.some((e=>e.checked)),t=l.filter((e=>e.checked));$.value=t,a("selectionChange",$.value),a("selectionChangeRow",e)},modelValue:e.checked,indeterminate:!1})],headerCellRenderer:()=>[(0,n.h)(u.ElCheckbox,{style:{display:s.checkAll?"line-block":"none"},onChange:e=>{var t=(0,o.SU)(C);C.value=t.map((t=>(t.checked=e,t))),I.value=t.every((e=>e.checked)),P.value=t.some((e=>e.checked)),$.value=I.value?t:[],a("selectionChange",$.value)},modelValue:I.value,indeterminate:P.value&&!I.value,disabled:0===C.value.length})]})};s.needCheckBox&&X();const j=()=>{N.value.push({key:"handle",width:s.endHandleWidth,fixed:i.V7.RIGHT,title:"操作",align:"center",cellRenderer:({rowData:e,rowIndex:t})=>s.defaultEndHandle?[(0,n.h)("div",{class:"table-handel-div"},[(0,n.h)(c.ElButton,{onClick:()=>{a("editRow",e)},type:"primary",icon:"Edit",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>"编辑"}),(0,n.h)(c.ElButton,{onClick:()=>{a("deleteRow",e)},type:"danger",icon:"Delete",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>"删除"})])]:s.customizeEndHandle(e,t),headerCellRenderer:()=>{var e=s.useUpdateHeader?"table-handel-btn":"table-handel-btn disable";return[(0,n.h)("div",{class:"table-handel-div-header"},[(0,n.h)("span",{style:"color:#fff;margin-right:10px"},"操作"),(0,n.h)(c.ElButton,{onClick:()=>{a("refresh")},title:"刷新",icon:"Refresh",text:!0,style:"color:#ffa500;background:transparent",class:"table-handel-btn"}),(0,n.h)(c.ElButton,{onClick:()=>{a("editTableHeader")},title:"调整表头",icon:"Operation",text:!0,style:"color:#ffa500;background:transparent",class:e})])]}})};if(s.needEndHandle&&j(),s.needFixedCheckData){const e=(0,o.iH)([]);(0,n.YP)((()=>$.value.length),(()=>{e.value.length=0,e.value.push(...$.value)}))}(0,n.YP)([()=>s.total,()=>s.tableData.length,()=>s.pageSize,()=>s.currentPage],(()=>{C.value=s.tableData})),(0,n.YP)((()=>b.currentRoute.value.path),((e,t)=>{-1===e.toLowerCase().indexOf("new")&&setTimeout((()=>{U.value?.scrollToTop(A.value-1),U.value?.scrollToLeft(0)}),0)})),(0,n.bv)((()=>{window.addEventListener("keydown",(e=>{"Control"===e.key&&(M.value=!0)})),window.addEventListener("keyup",(e=>{"Control"===e.key&&(M.value=!1)})),s.needExpand||(window.addEventListener("mousemove",(e=>{z.value&&M.value&&(B.value=Math.abs(e.y-K.value),L.value=Math.abs(e.x-F.value),e.x-F.value<0&&e.y-K.value<0?R.value="left":R.value="right")})),window.addEventListener("mouseup",(e=>{z.value&&(z.value=!1,B.value=0,L.value=0,F.value=-1,K.value=-1,a("selectionChange",$.value))})));const e=JSON.parse(localStorage.getItem("userSettings"));e&&e.tableSetting&&e.tableSetting.headerColor&&0!==e.tableSetting.headerColor.length&&setTimeout((()=>{var t=document.getElementsByClassName("el-table-v2__header-cell");if(t)for(let a=0;a<t.length;a++)t[a].style.backgroundColor=e.tableSetting.headerColor})),Z()}));const Y=e=>{A.value=e.scrollTop},J=(0,o.iH)(""),Z=()=>{var e=document.querySelector(".table-virtual");const t=document.querySelector(".contextmenu-content");t.addEventListener("contextmenu",(e=>{e.preventDefault()}),!1),e.addEventListener("contextmenu",(e=>{e.preventDefault(),J.value=e.target.title,t.style.display="none",t.style.display="block",t.style.left=e.clientX+"px",t.style.top=e.clientY+"px"}),!1),window.addEventListener("click",(()=>{"block"===t.style.display&&(t.style.display="none")}),!1)},G=()=>{var e=navigator.clipboard;0!==J.value.trim().length&&J.value?e.writeText(J.value).then((()=>{w.$message.success("已成功复制到剪切板")})).catch((e=>{})):w.$message.error("空白内容无法复制到剪贴板")},Q=(0,o.iH)("rgba(41, 155, 72,.5)");return t({clearSelection:()=>{setTimeout((()=>{for(let e=0;e<C.value.length;e++)C.value[e].checked=!1;C.value=s.tableData,I.value=!1,P.value=!1,$.value=[],a("selectionChange",$.value)}),0)},handInitColumns:(e,t)=>{let a=0;N.value.forEach((e=>{e.canMove=!1,e.align="left",e.fixed=e.isFixed?i.V7.LEFT:"",e.key=e.key||e.prop,e.dataKey=e.key,e.title=e.title||e.label,e.headerCellRenderer=s.needDynamicEditingHeader?({column:t})=>[(0,n.h)("div",{class:`header-cell-${e.dataKey} header-cell`,title:e.title},e.title,[(0,n.h)("div",{onMousedown:l=>{a=l.clientX,l=document.querySelectorAll(".el-table-v2__header-row");let n=document.querySelector(".header-border-"+e.dataKey);l[0].style.cursor="e-resize",l[1].style.cursor="e-resize",t.canMove=!0,l[0]?.addEventListener("mousemove",(e=>{t.canMove&&(n.style.left=t.width-15+(e.clientX-a)+"px")})),l[1]?.addEventListener("mousemove",(e=>{t.canMove&&(n.style.left=t.width-15+(e.clientX-a)+"px")})),l[0]?.addEventListener("mouseup",(l=>{var n=document.querySelector(".header-border-"+e.dataKey),d=document.querySelectorAll(".el-table-v2__header-row");d[0].style.cursor="default",d[1].style.cursor="default",0<+n.style.left.replace("px","")+15?(t.width=+n.style.left.replace("px","")+15,t.canMove=!1,a=0):n.style.left=t.width-15})),l[1]?.addEventListener("mouseup",(l=>{var n=document.querySelector(".header-border-"+e.dataKey),d=document.querySelectorAll(".el-table-v2__header-row");d[0].style.cursor="default",d[1].style.cursor="default",0<+n.style.left.replace("px","")+15?(t.width=+n.style.left.replace("px","")+15,t.canMove=!1,a=0):n.style.left=t.width-15}))},class:`header-border-${e.dataKey} header-border`,style:`left:${e.width-15}px;top:-14px`})])]:()=>[(0,n.h)("div",{class:`header-cell-${e.dataKey} header-cell`,title:e.title},e.title)],e.cellRenderer=({rowData:e,column:t,rowIndex:a})=>{var l=s.forMatData(t.dataKey,e[t.dataKey],e,t);return O({rowData:e,rowIndex:a,column:t,forMatValue:l})}})),e&&X(),t&&j()},closeTree:()=>{k.value.length=0},handleRender:()=>{X(),j()}}),(t,l)=>{const i=(0,n.up)("el-icon"),u=(0,n.up)("el-table-v2");var c=(0,n.up)("el-auto-resizer"),s=(0,n.up)("el-pagination");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",{style:(0,d.j5)({width:"100%",paddingBottom:e.needPagination?0:"10px",boxSizing:"border-box"}),class:"table table-virtual"},[(0,n.Wm)(c,null,{default:(0,n.w5)((({width:a})=>[(0,n.Wm)(u,{ref_key:"tableRef",ref:U,"expanded-row-keys":k.value,"onUpdate:expandedRowKeys":l[0]||(l[0]=e=>k.value=e),cache:e.cache,columns:N.value,"row-class":e.rowClass,data:(0,o.SU)(C),width:a,height:H.value,"row-key":e.rowKey,"row-height":38,"header-height":38,"expand-column-key":e.needExpand?N.value[0].key:"","estimated-row-height":e.estimatedRowHeight,"fixed-data":e.needFixedCheckData?t.fixedData:[],fixed:"",onScroll:Y},(0,n.Nv)({empty:(0,n.w5)((()=>[h])),row:(0,n.w5)((e=>[(0,n.Wm)((0,o.SU)(V),(0,d.vs)((0,n.F4)(e)),null,16)])),_:2},[e.loading?{name:"overlay",fn:(0,n.w5)((()=>[(0,n._)("div",y,[(0,n.Wm)(i,{class:"is-loading",color:"var(--el-color-primary)",size:26},{default:(0,n.w5)((()=>[(0,n.Wm)((0,o.SU)(r.Loading))])),_:1}),(0,n._)("div",p,(0,d.zw)(e.loadPrompt),1)])])),key:"0"}:void 0,e.showFooter?{name:"footer",fn:(0,n.w5)((()=>[(0,n.WI)(t.$slots,"customizeFooter")])),key:"1"}:void 0]),1032,["expanded-row-keys","cache","columns","row-class","data","width","height","row-key","expand-column-key","estimated-row-height","fixed-data"])])),_:3}),(0,n._)("div",f,[(0,n.Wm)(s,{"current-page":E.value,"onUpdate:currentPage":l[1]||(l[1]=e=>E.value=e),"page-size":S.value,"onUpdate:pageSize":l[2]||(l[2]=e=>S.value=e),background:"","default-current-page":1,layout:e.needChangeSize?"total, sizes, prev, pager, next, jumper":"total, prev, pager, next, jumper","page-sizes":[10,20,30,50,100,500,1e3,5e3,1e4,1e5,1e6],total:e.needPagination?e.total:(0,o.SU)(C).length,onSizeChange:D,onCurrentChange:_},null,8,["current-page","page-size","layout","total"])]),(0,n._)("div",{class:(0,d.C_)(["select-square","left"===R.value?"rotate1":"rotate2"]),style:(0,d.j5)({top:K.value+"px",left:F.value+"px",height:B.value+"px",width:L.value+"px"})},null,6)],4),(0,n._)("div",m,[(0,n._)("div",g,[(0,n._)("div",{class:"item",onClick:l[3]||(l[3]=(...e)=>G(...e))}," 复制 "),(0,n._)("div",{class:"item",onClick:l[4]||(l[4]=e=>a("refresh"))}," 刷新 "),(0,n._)("div",{class:"item",onClick:l[5]||(l[5]=e=>a("save"))}," 保存 ")])])],64)}}};var w=(0,a(40089).Z)(t,[["__scopeId","data-v-ebadeb7c"]])}}]);