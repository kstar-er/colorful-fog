"use strict";(self.webpackChunksystem=self.webpackChunksystem||[]).push([[9809],{82134:function(e,a,t){t.d(a,{V:function(){return l.V},o:function(){return d}}),t(57658);var l=t(81081),n=(a=t(20566),t(68521));class d extends a.Z{constructor({modules:e="",selectUri:a="/",deleteUri:t="/",selectOneUri:l="/",pageSize:n=20,tableHeader:d}={}){super({modules:e,selectUri:a,deleteUri:t,selectOneUri:l,pageSize:n,tableHeader:d})}async initData(e=this,a){var{data:t,code:n}=(await l.K.post(`${e.selectUri}?currentPage=${e.currentPage}&pageSize=`+e.pageSize,e.searchData))["data"];200===n&&(e.total=t.pageInfo.total,e.tableData.length=0,e.tableData.push(...t.pageInfo.list),a?.clearSelection())}currentPageChange(e,a=this,t){a.currentPage=e,a.initData(a,t)}pageSizeChange(e,a=this,t){a.currentPage=1,a.pageSize=e,a.initData(a,t)}search(e,a=this,t){a.searchData=e,a.currentPage=1,a.initData(a,t,!0)}forMatData(e,a){return"dependType"!==e?e&&a&&(-1!==e.indexOf("Time")||-1!==e.indexOf("Date"))?(new n.x).timeStamp2Time(a,"yyyy-MM-dd hh:mm:ss"):a&&0<a.toString().length||"number"==typeof a?a:"-":{SORT:"名词分类",RANGE:"范围分类",DEPEND:"二次分类",OTHER:"其他"}[a]}async addDependMain(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependMain/addDependMain",e))["data"];return 200===e?{data:a,code:e}:t}async updateDependMain(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependMain/updateDependMain",e))["data"];return 200===e?{data:a,code:e}:t}async deleteDependMain(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependMain/deleteDependMain",e))["data"];return 200===e?{data:a,code:e}:t}async addDependRule(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependRule/addDependRule",e))["data"];return 200===e?{data:a,code:e}:t}async updateDependRule(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependRule/updateDependRule",e))["data"];return 200===e?{data:a,code:e}:t}async deleteDependRule(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependRule/deleteDependRule",e))["data"];return 200===e?{data:a,code:e}:t}async addDependDataBatch(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependData/addDependDataBatch",e))["data"];return 200===e?{data:a,code:e}:t}async updateDependData(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependData/updateDependData",e))["data"];return 200===e?{data:a,code:e}:t}async deleteDependData(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependData/deleteDependData",e))["data"];return 200===e?{data:a,code:e}:t}async deleteDependData(e){var{code:e,data:a,msg:t}=(await l.K.post("/colorful-fog/dependData/deleteDependData",e))["data"];return 200===e?{data:a,code:e}:t}}},51881:function(e,a){a.Z={name:"",key:"",policy:"eyJleHBpcmF0aW9uIjoiMzAyMi0wMS0wMVQxMjowMDowMC4wMDBaIiwiY29uZGl0aW9ucyI6W1siY29udGVudC1sZW5ndGgtcmFuZ2UiLDAsMTA0ODU3NjAwMF1dfQ==",OSSAccessKeyId:"LTAI5t7u1jzmji9stQ5LzCpe",success_action_status:"200",signature:"tF/dwb/qvoQjHffu0kq5FWQq9KY="}},62018:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}}),t(57658);var l=t(73396),n=t(44870),d=t(87139),o=t(44385),i=t(6094),r=t(83762),s=t(12862),u=t(82134),c=t(22483),p=t(82261),m=t(59971),f=t(51881);const g={class:"data-filter"},h={class:"extend-handle"},y={class:"extend-handle-left"},v=["id"];a={__name:"relationship",setup(e){const a=(0,c.tv)(),t=(0,c.yj)(),w=(0,l.Q2)("authority"),D=(0,n.iH)(f.Z),b=(0,l.FN)()["proxy"],S=(0,n.iH)(!1),k=(0,n.iH)(null),T=()=>{k.value=new u.o({modules:"relationship",selectUri:"/colorful-fog/dependMain/list"}),k.value.initTableHeader(),k.value.initData(this,b.$refs.table)},C=((0,l.wF)((()=>{T()})),async()=>{M.value={isLoseEfficacy:!1,dependType:"SORT"},H.isShow=!0}),x=async e=>{M.value=e,H.isShow=!0},E=e=>{k.value.search(e,this,b.$refs.table)},U=e=>e.admin?[(0,l.h)("div",{class:"table-handel-div no-options"},"暂无操作")]:[(0,l.h)("div",{class:"table-handel-div"},[(0,l.wy)((0,l.h)(p.ElButton,{class:"hover-animation",onClick:()=>{x(e)},title:"编辑",style:"padding:0;margin:0;background:transparent;width:80px;color:#0c81b1;margin-right:10px"},{default:()=>"编辑"}),[[w,"summaryPlan:add"]]),(0,l.wy)((0,l.h)(p.ElButton,{class:"hover-animation",onClick:()=>{_(e)},title:"查看明细",style:"padding:0;margin:0;background:transparent;width:80px;color:#0c81b1;margin-right:10px"},{default:()=>"修改明细"}),[[w,"summaryPlan:add"]]),(0,l.wy)((0,l.h)(p.ElButton,{class:"hover-animation",onClick:()=>{I(e)},title:"删除",style:"padding:0;margin:0;background:transparent;width:80px;color:red;"},{default:()=>"关闭依赖"}),[[w,"summaryPlan:delete"]])])],_=e=>{a.push(`/detail/relationshipDetail?id=${e.id}&dependCode=${e.dependCode}&dependType=${e.dependType}&title=${t.meta.title}&name=`+e.name)},M=(0,n.iH)({}),H=(0,n.qj)({isShow:!1,formInputEl:[{title:"依赖关系名称",key:"name",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}],formSelectEl:[{title:"是否启用",key:"isLoseEfficacy",element:"radio",options:[{label:"是",value:!1},{label:"否",value:!0}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"类型",key:"dependType",element:"radio",options:[{label:"名词分类",value:"SORT"},{label:"范围分类",value:"RANGE"}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}],formTextAreaEl:[],formTimeAndNumber:[],emitOpenDialog:e=>{},inputDone:e=>{b.$alert("是否确认提交？","提示",{type:"info",icon:"InfoFilled",confirmButtonText:"确定",callback:a=>{"confirm"===a&&(e.id?k.value.updateDependMain(e).then((e=>{200===e.code&&(H.isShow=!1,b.$message.success("更新成功"),k.value.initData(this,b.$refs.table))})):k.value.addDependMain(e).then((e=>{200===e.code&&(H.isShow=!1,b.$message.success("新增成功"),k.value.initData(this,b.$refs.table))})))}})}}),z=({forMatValue:e,column:a,rowData:t})=>{if("isLoseEfficacy"!==a.key)return e;{a=t.isLoseEfficacy?"danger":"success";let e=t.isLoseEfficacy?"已失效":"生效中";return(0,l.h)(m.Ks,{type:a},{default:()=>e})}},I=async e=>{b.$alert("是否关闭使用当前依赖？","提示",{type:"error",icon:"InfoFilled",confirmButtonText:"确定",callback:a=>{"confirm"===a&&(a=[e.id],k.value.deleteDependMain(a).then((e=>{200===e.code&&b.$alert("关闭成功","提示",{type:"success",icon:"InfoFilled",showCancelButton:!1,callback:()=>{k.value.initData(this,b.$refs.table)}})})))}})};return(e,a)=>{const t=(0,l.up)("CircleCloseFilled"),c=(0,l.up)("el-icon");var m=(0,l.up)("el-drawer"),f=(0,l.Q2)("authorityHandle");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",g,[(0,l.Wm)(s.Z,{"filter-items":k.value.tableHeader,onSearch:E},null,8,["filter-items"])]),(0,l._)("div",h,[(0,l._)("div",y,[(0,l.wy)(((0,l.wg)(),(0,l.j4)((0,n.SU)(p.ElButton),{class:"handle-btn",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:C},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增 ")])),_:1})),[[f,"summaryPlan:add"]])])]),(0,l.Wm)(r.Z,{ref:"table","need-end-handle":"","need-check-box":"","need-customize-cell-renderer":"","row-key":"roleId","end-handle-width":300,total:k.value.total,"current-page":k.value.currentPage,"page-size":k.value.pageSize,"table-data":k.value.tableData,columns:k.value.tableHeader,loading:(0,n.SU)(u.V)&&!H.isShow,"default-end-handle":!1,"customize-end-handle":U,"for-mat-data":k.value.forMatData,"customize-cell-renderer":z,onSelectionChange:a[0]||(a[0]=e=>k.value.selectionChange(e,k.value,(0,n.SU)(b).$refs.table)),onRefresh:a[1]||(a[1]=e=>k.value.initData(k.value,(0,n.SU)(b).$refs.table)),onEditRow:x,onCurrentChange:a[2]||(a[2]=e=>k.value.currentPageChange(e,k.value,(0,n.SU)(b).$refs.table)),onSizeChange:a[3]||(a[3]=e=>k.value.pageSizeChange(e,k.value,(0,n.SU)(b).$refs.table)),onEditTableHeader:a[4]||(a[4]=e=>S.value=!0)},null,8,["total","current-page","page-size","table-data","columns","loading","for-mat-data"]),(0,l.Wm)(m,{modelValue:S.value,"onUpdate:modelValue":a[6]||(a[6]=e=>S.value=e),"show-close":!1},{header:(0,l.w5)((({titleId:e,titleClass:o})=>[(0,l._)("h4",{id:e,class:(0,d.C_)(o)}," 通过拖拽设置您喜欢的表头顺序 ",10,v),(0,l.Wm)((0,n.SU)(p.ElButton),{type:"danger",onClick:a[5]||(a[5]=e=>S.value=!1)},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"el-icon--left"},{default:(0,l.w5)((()=>[(0,l.Wm)(t)])),_:1}),(0,l.Uk)(" 关闭 ")])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(i.Z,{"is-show-edit-table-header":S.value,modules:"role"},null,8,["is-show-edit-table-header"])])])),_:1},8,["modelValue"]),H.isShow?((0,l.wg)(),(0,l.j4)(o.Z,{key:0,ref:"dialogForm",width:"60%",loading:(0,n.SU)(u.V),"my-client":D.value,"form-data":M.value,"is-show":H.isShow,title:"请填写相关信息","form-input-el":H.formInputEl,"form-select-el":H.formSelectEl,"form-text-area-el":H.formTextAreaEl,"form-upload-el":H.formUploadEl,"form-time-and-number":H.formTimeAndNumber,onCloseDialog:a[7]||(a[7]=e=>H.isShow=!1),onEmitOpenDialog:H.emitOpenDialog,onInputDone:H.inputDone},null,8,["loading","my-client","form-data","is-show","form-input-el","form-select-el","form-text-area-el","form-upload-el","form-time-and-number","onEmitOpenDialog","onInputDone"])):(0,l.kq)("",!0)])}}};var w=(0,t(40089).Z)(a,[["__scopeId","data-v-6cc5f8d6"]])},6094:function(e,a,t){t.d(a,{Z:function(){return m}}),t(57658);var l=t(73396),n=t(44870),d=t(49242),o=t(87139),i=t(98249),r=t(40130),s=t(46623);const u={class:"container"},c={class:"drag-box"},p={class:"drag-btn"};a={__name:"dynamicHeader",props:{isShowEditTableHeader:{type:Boolean,default:!1},modules:{type:String,default:""},filterList:{type:Array,default:()=>[]}},emits:["updateCompleted"],setup(e,{emit:a}){const t=e,{_state:m,commit:f}=(0,s.oR)(),g=m.data[t.modules].defaultTableHeader,h=(0,n.qj)([]),y=(0,n.iH)(!1),v=((0,l.wF)((()=>{(h.length=0)===t.filterList.length?h.push(...m.data[t.modules].tableHeader):m.data[t.modules].tableHeader.forEach((e=>{t.filterList.includes(e.key)||h.push(e)}))})),e=>{y.value=!1}),w=()=>{r.T.confirm("重置之后保存的数据将会丢失，是否继续？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{h.length=0,h.push(...JSON.parse(JSON.stringify(g))),f(t.modules+"/updateTableHeader",h),r.T.alert("修改成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{a("updateCompleted"),location.reload()}}),a("updateCompleted")})).catch((()=>{}))},D=()=>{r.T.confirm("确认保存？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{0!==t.filterList.length&&m.data[t.modules].tableHeader.forEach((e=>{t.filterList.includes(e.key)&&h.push(e)})),f(t.modules+"/updateTableHeader",h),r.T.alert("设置成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{a("updateCompleted"),location.reload()}})})).catch((()=>{}))};return(e,a)=>{const t=(0,l.up)("el-tag"),r=(0,l.up)("el-checkbox");var s=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("div",c,[(0,l.Wm)((0,n.SU)(i.J),{list:h,"chosen-class":"chosen",group:"name","force-fallback":"true",animation:"500","fallback-tolerance":4,onStart:a[0]||(a[0]=e=>y.value=!0),onEnd:v},{default:(0,l.w5)((()=>[(0,l.Wm)(d.W3,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(h,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.key||e.prop,class:"item"},[(0,l.Wm)(t,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.title||e.label),1)])),_:2},1024),(0,l._)("div",null,[(0,l.Wm)(r,{modelValue:e.isFixed,"onUpdate:modelValue":a=>e.isFixed=a,label:"固定在左边",size:"large"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(r,{modelValue:e.isShow,"onUpdate:modelValue":a=>e.isShow=a,label:"是否展示",size:"large"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])),_:1})])),_:1},8,["list"])]),(0,l._)("div",p,[(0,l.Wm)(s,{type:"warning",onClick:w},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1}),(0,l.Wm)(s,{type:"primary",onClick:D},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1})])])}}};var m=(0,t(40089).Z)(a,[["__scopeId","data-v-4c5f22fa"]])}}]);