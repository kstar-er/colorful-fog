"use strict";(self.webpackChunksystem=self.webpackChunksystem||[]).push([[5244],{51881:function(e,l){l.Z={name:"",key:"",policy:"eyJleHBpcmF0aW9uIjoiMzAyMi0wMS0wMVQxMjowMDowMC4wMDBaIiwiY29uZGl0aW9ucyI6W1siY29udGVudC1sZW5ndGgtcmFuZ2UiLDAsMTA0ODU3NjAwMF1dfQ==",OSSAccessKeyId:"LTAI5t7u1jzmji9stQ5LzCpe",success_action_status:"200",signature:"tF/dwb/qvoQjHffu0kq5FWQq9KY="}},95244:function(e,l,t){t.r(l),t.d(l,{default:function(){return x}}),t(57658);var a=t(73396),n=t(87139),o=t(44870),i=t(29833),d=t(78449),s=t(44385),r=t(6094),u=t(83762),c=t(12862),m=t(29288),p=t(40130),f=t(82261),h=t(59971),v=t(51881),g=t(22483);l=e=>((0,a.dD)("data-v-e0314664"),e=e(),(0,a.Cn)(),e);const w={class:"data-filter"},b={class:"extend-handle"},y={class:"extend-handle-left"},k=["id"],_={class:"jx-dialog-header"},S=["id"],C=[l((()=>(0,a._)("h4",{class:"inline-block"}," 修改账单分组 ",-1)))],D=l((()=>(0,a._)("span",{class:"mr10"},"选择或输入你想变更的分组",-1))),U={class:"mt10"},W={key:0};l={__name:"programmeList",setup(e){const l=(0,g.tv)(),t=(0,a.Q2)("authority"),x=(0,o.iH)(v.Z),H=(0,a.FN)()["proxy"],B=(0,o.iH)(!1),T=(0,o.iH)(null),I=JSON.parse(sessionStorage.getItem("userInfo")).permissions,E=()=>{T.value=new m.o2({modules:"programme",selectUri:"/colorful-fog/schemeMain/selectMenu"}),T.value.initTableHeader(),T.value.initData(this,H.$refs.table)},V=(0,o.iH)(!1),$=((0,a.wF)((()=>{E()})),(0,o.iH)(!1)),z=(0,o.iH)(0),F=async({id:e,sort:l})=>{z.value=e,j.value=l,$.value=!0},j=(0,o.iH)(""),L=(0,o.iH)([]),M=(0,o.iH)(""),Z=e=>{e&&T.value.getSolutionList().then((e=>{200===e.code&&(L.value=e.data)}))},A=()=>{p.T.prompt("请输入方案名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=>{P(e.value)})).catch((()=>{}))},P=e=>{"新增方案"===e?A():(z.value=-1,j.value=e,$.value=!0)},O=e=>{T.value.search(e,this,H.$refs.table)};let q=[{per:"settlementPlan:refresh",label:"刷新账单",command:"refresh"},{per:"settlementPlan:delete",label:"删除计划",command:"delete"},{per:"settlementPlan:createBill",label:"生成账单",command:"createBill"},{per:"settlementPlan:add",label:"修改账单分组",command:"updateGroup"}];const N=e=>e.id?[(0,a.h)("div",{class:"table-handel-div"},[(0,a.wy)((0,a.h)(f.ElButton,{class:"hover-animation",onClick:()=>{F(e)},title:"编辑计划",style:"padding:0;margin:0;background:transparent;width:80px;color:#0c81b1;margin-right:10px"},{default:()=>"编辑计划"}),[[t,"settlementPlan:add"]]),(0,a.wy)((0,a.h)(f.ElButton,{class:"hover-animation",onClick:()=>{G(e)},title:"查看此计划账单",style:"padding:0;margin:0;background:transparent;width:80px;color:#16d46b;margin-right:10px"},{default:()=>"查看账单"}),[[t,"settlementPlan:check"]]),(0,a.h)(i.Z,{title:"更多",needPerList:q,onDoAction:l=>{J(e,l)}})])]:[(0,a.h)("div",{class:"table-handel-div no-options"},"暂无操作")];let Y={};const J=(e,l)=>{switch(l){case"refresh":return void Q(e);case"delete":return void te(e);case"createBill":return void K(e);case"updateGroup":Y=e,M.value=Y.sort,T.value.getSolutionList().then((e=>{200===e.code&&(L.value=e.data,V.value=!0)}))}},K=e=>{H.$alert("是否确认生成账单数据？","提示",{type:"info",icon:"InfoFilled",confirmButtonText:"确定",callback:l=>{"confirm"===l&&T.value.createBill({code:e.schemeCode}).then((e=>{200===e.code&&(X.isShow=!1,H.$message.success("生成成功"),T.value.initData(this,H.$refs.table))}))}})},Q=e=>{e={schemeCode:e.schemeCode},T.value.refresh(e).then((e=>{200===e.code&&H.$alert("刷新成功","提示",{type:"success",icon:"InfoFilled",showCancelButton:!1,callback:()=>{T.value.initData(this,H.$refs.table)}})}))},G=e=>{l.push("/financial/Detail/billingdata?schemeCode="+e.schemeCode+"&name="+e.name)},R=(0,o.iH)({}),X=(0,o.qj)({isShow:!1,formInputEl:[{title:"部门名称",key:"deptName",element:"input"},{title:"部门负责人",key:"leader",element:"input",type:"dialog",canInput:!0},{title:"负责人联系电话",key:"phone",element:"input"},{title:"邮箱",key:"email",element:"input"}],formSelectEl:[{title:"所属上级部门",key:"parentId",element:"selectTree",options:[],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"部门状态",key:"status",element:"radio",options:[{label:"正常",value:"0"},{label:"停用",value:"1"}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}],formTimeAndNumber:[{title:"显示顺序",key:"orderNum",element:"number"}],formTextAreaEl:[{title:"备注",key:"remark",element:"input",type:"textarea"}],emitOpenDialog:e=>{},inputDone:async e=>{e={...e},e.deptId?200===(await T.value.updateDept(e)).code&&(H.$message.success("更新成功"),T.value.initData(this,H.$refs.table),X.isShow=!1):200===(await T.value.addDept(e)).code&&(H.$message.success("新增成功"),T.value.initData(this,H.$refs.table),X.isShow=!1)}}),ee=({forMatValue:e,column:l,rowData:t})=>"status"===l.key?[(0,a.h)(h.Ks,{type:"0"===t[l.key]?"":"danger"},{default:()=>e})]:e,le=()=>{H.$refs.table.closeTree()},te=e=>{H.$alert("是否确认删除当前数据？","提示",{type:"error",icon:"InfoFilled",confirmButtonText:"确定",callback:l=>{"confirm"===l&&(l=[e.id],T.value.deleteSchemeMain(l).then((e=>{200===e.code&&H.$alert("删除成功","提示",{type:"success",icon:"InfoFilled",showCancelButton:!1,callback:()=>{T.value.initData(this,H.$refs.table)}})})))}})},ae=()=>{T.value.initData(this,H.$refs.table),$.value=!1},ne=()=>{l.push("/programmeDetail")},oe=()=>{Y.sort=M.value,(0,m.WJ)(Y).then((e=>{200===e.code&&(T.value.initData(this,H.$refs.table),V.value=!1,H.$message.success("更新成功"))}))};return(e,l)=>{const t=(0,a.up)("CirclePlus"),i=(0,a.up)("el-icon"),p=(0,a.up)("el-dropdown-item"),h=(0,a.up)("el-dropdown-menu");var v=(0,a.up)("el-dropdown");const g=(0,a.up)("CircleCloseFilled");var E=(0,a.up)("el-drawer");const A=(0,a.up)("el-option"),q=(0,a.up)("el-select");var Y=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",{class:(0,n.C_)($.value?"move":"")},[(0,a._)("div",w,[(0,a.Wm)(c.Z,{"filter-items":T.value.tableHeader,onSearch:O},null,8,["filter-items"])]),(0,a._)("div",b,[(0,a._)("div",y,[(0,a.Wm)((0,o.SU)(f.ElButton),{class:"handle-btn mr10",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:le},{default:(0,a.w5)((()=>[(0,a.Uk)(" 全部折叠 ")])),_:1}),(0,o.SU)(I).includes("settlementPlan:add")||(0,o.SU)(I).includes("*:*:*")?((0,a.wg)(),(0,a.j4)(v,{key:0,trigger:"click",onCommand:P,onVisibleChange:Z},{dropdown:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(L.value??[],((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:l},[(0,a.Wm)(p,{command:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e),1)])),_:2},1032,["command"])])))),128)),(0,a.Wm)(p,{command:"新增方案",divided:""},{default:(0,a.w5)((()=>[(0,a.Uk)(" 新增方案 ")])),_:1})])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)((0,o.SU)(f.ElButton),{class:"handle-btn mr10",color:"#4a78bd",style:{color:"#666"},plain:""},{default:(0,a.w5)((()=>[(0,a.Uk)(" 新增一个方案 "),(0,a.Wm)(i,{class:"ml10"},{default:(0,a.w5)((()=>[(0,a.Wm)(t)])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)((0,o.SU)(f.ElButton),{class:"handle-btn mr10",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:ne},{default:(0,a.w5)((()=>[(0,a.Uk)(" 方案绑定情况 ")])),_:1})])]),(0,a.Wm)(u.Z,{ref:"table","need-end-handle":"","need-customize-cell-renderer":"","need-expand":"","row-key":"name","need-check-box":!1,"need-pagination":!1,total:T.value.total,"current-page":T.value.currentPage,"page-size":T.value.pageSize,"table-data":T.value.tableData,columns:T.value.tableHeader,loading:(0,o.SU)(m.V_)&&!X.isShow,"default-end-handle":!1,"customize-end-handle":N,"for-mat-data":T.value.forMatData,"customize-cell-renderer":ee,"end-handle-width":260,onSelectionChange:l[0]||(l[0]=e=>T.value.selectionChange(e,T.value,(0,o.SU)(H).$refs.table)),onRefresh:l[1]||(l[1]=e=>T.value.initData(T.value,(0,o.SU)(H).$refs.table)),onEditRow:F,onCurrentChange:l[2]||(l[2]=e=>T.value.currentPageChange(e,T.value,(0,o.SU)(H).$refs.table)),onSizeChange:l[3]||(l[3]=e=>T.value.pageSizeChange(e,T.value,(0,o.SU)(H).$refs.table)),onEditTableHeader:l[4]||(l[4]=e=>B.value=!0)},null,8,["total","current-page","page-size","table-data","columns","loading","for-mat-data"]),(0,a.Wm)(E,{modelValue:B.value,"onUpdate:modelValue":l[6]||(l[6]=e=>B.value=e),"show-close":!1},{header:(0,a.w5)((({titleId:e,titleClass:t})=>[(0,a._)("h4",{id:e,class:(0,n.C_)(t)}," 通过拖拽设置您喜欢的表头顺序 ",10,k),(0,a.Wm)((0,o.SU)(f.ElButton),{type:"danger",onClick:l[5]||(l[5]=e=>B.value=!1)},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"el-icon--left"},{default:(0,a.w5)((()=>[(0,a.Wm)(g)])),_:1}),(0,a.Uk)(" 关闭 ")])),_:1})])),default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(r.Z,{"is-show-edit-table-header":B.value,modules:"depart"},null,8,["is-show-edit-table-header"])])])),_:1},8,["modelValue"]),X.isShow?((0,a.wg)(),(0,a.j4)(s.Z,{key:0,ref:"dialogForm",width:"60%",loading:(0,o.SU)(m.V_),"my-client":x.value,"form-data":R.value,"is-show":X.isShow,title:"请填写相关信息","form-input-el":X.formInputEl,"form-select-el":X.formSelectEl,"form-text-area-el":X.formTextAreaEl,"form-upload-el":X.formUploadEl,"form-time-and-number":X.formTimeAndNumber,onCloseDialog:l[7]||(l[7]=e=>X.isShow=!1),onEmitOpenDialog:X.emitOpenDialog,onInputDone:X.inputDone},null,8,["loading","my-client","form-data","is-show","form-input-el","form-select-el","form-text-area-el","form-upload-el","form-time-and-number","onEmitOpenDialog","onInputDone"])):(0,a.kq)("",!0)],2),(0,a.Wm)(Y,{modelValue:V.value,"onUpdate:modelValue":l[10]||(l[10]=e=>V.value=e),"lock-scroll":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"30%",top:"4%","destroy-on-close":""},{header:(0,a.w5)((({titleId:e,titleClass:t})=>[(0,a._)("div",_,[(0,a._)("div",{id:e,class:(0,n.C_)(t)},C,10,S),(0,a._)("div",null,[(0,a.Wm)((0,o.SU)(f.ElButton),{class:"dialog-close-btn",type:"danger",icon:"CloseBold",circle:"",onClick:l[8]||(l[8]=e=>V.value=!1)})])])])),default:(0,a.w5)((()=>[(0,a._)("div",null,[D,(0,a.Wm)(q,{modelValue:M.value,"onUpdate:modelValue":l[9]||(l[9]=e=>M.value=e),placeholder:"选择或输入你想变更的分组",style:{width:"240px"},filterable:"","allow-create":""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(L.value,(e=>((0,a.wg)(),(0,a.j4)(A,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,a._)("div",U,[(0,a.Wm)((0,o.SU)(f.ElButton),{type:"primary",style:{float:"right","margin-right":"10px"},onClick:oe},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确定 ")])),_:1})])])),_:1},8,["modelValue"]),$.value?((0,a.wg)(),(0,a.iD)("div",W,[(0,a.Wm)(d.default,{"edit-id":z.value,"add-type":j.value,onBack:ae},null,8,["edit-id","add-type"])])):(0,a.kq)("",!0)],64)}}};var x=(0,t(40089).Z)(l,[["__scopeId","data-v-e0314664"]])},6094:function(e,l,t){t.d(l,{Z:function(){return p}}),t(57658);var a=t(73396),n=t(44870),o=t(49242),i=t(87139),d=t(98249),s=t(40130),r=t(46623);const u={class:"container"},c={class:"drag-box"},m={class:"drag-btn"};l={__name:"dynamicHeader",props:{isShowEditTableHeader:{type:Boolean,default:!1},modules:{type:String,default:""},filterList:{type:Array,default:()=>[]}},emits:["updateCompleted"],setup(e,{emit:l}){const t=e,{_state:p,commit:f}=(0,r.oR)(),h=p.data[t.modules].defaultTableHeader,v=(0,n.qj)([]),g=(0,n.iH)(!1),w=((0,a.wF)((()=>{(v.length=0)===t.filterList.length?v.push(...p.data[t.modules].tableHeader):p.data[t.modules].tableHeader.forEach((e=>{t.filterList.includes(e.key)||v.push(e)}))})),e=>{g.value=!1}),b=()=>{s.T.confirm("重置之后保存的数据将会丢失，是否继续？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{v.length=0,v.push(...JSON.parse(JSON.stringify(h))),f(t.modules+"/updateTableHeader",v),s.T.alert("修改成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{l("updateCompleted"),location.reload()}}),l("updateCompleted")})).catch((()=>{}))},y=()=>{s.T.confirm("确认保存？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{0!==t.filterList.length&&p.data[t.modules].tableHeader.forEach((e=>{t.filterList.includes(e.key)&&v.push(e)})),f(t.modules+"/updateTableHeader",v),s.T.alert("设置成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{l("updateCompleted"),location.reload()}})})).catch((()=>{}))};return(e,l)=>{const t=(0,a.up)("el-tag"),s=(0,a.up)("el-checkbox");var r=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("div",c,[(0,a.Wm)((0,n.SU)(d.J),{list:v,"chosen-class":"chosen",group:"name","force-fallback":"true",animation:"500","fallback-tolerance":4,onStart:l[0]||(l[0]=e=>g.value=!0),onEnd:w},{default:(0,a.w5)((()=>[(0,a.Wm)(o.W3,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.key||e.prop,class:"item"},[(0,a.Wm)(t,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.title||e.label),1)])),_:2},1024),(0,a._)("div",null,[(0,a.Wm)(s,{modelValue:e.isFixed,"onUpdate:modelValue":l=>e.isFixed=l,label:"固定在左边",size:"large"},null,8,["modelValue","onUpdate:modelValue"]),(0,a.Wm)(s,{modelValue:e.isShow,"onUpdate:modelValue":l=>e.isShow=l,label:"是否展示",size:"large"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])),_:1})])),_:1},8,["list"])]),(0,a._)("div",m,[(0,a.Wm)(r,{type:"warning",onClick:b},{default:(0,a.w5)((()=>[(0,a.Uk)(" 重置 ")])),_:1}),(0,a.Wm)(r,{type:"primary",onClick:y},{default:(0,a.w5)((()=>[(0,a.Uk)(" 保存 ")])),_:1})])])}}};var p=(0,t(40089).Z)(l,[["__scopeId","data-v-4c5f22fa"]])},29833:function(e,l,t){t.d(l,{Z:function(){return d}}),t(57658);var a=t(73396),n=t(87139),o=t(44870);const i={class:"el-dropdown-link flex-center",style:{outline:"none"}};l={__name:"moreOptions",props:{title:{type:String,default:"更多"},needPerList:{type:Object,default:()=>[]}},emits:["doAction"],setup(e,{emit:l}){const t=e,d=(0,o.qj)([]),s=e=>l("doAction",e),r=e=>{d.length=0;const l=JSON.parse(sessionStorage.getItem("userInfo")).permissions;l.includes("*:*:*")?d.push(...t.needPerList):t.needPerList.forEach((e=>{l.includes(e.per)&&d.push(e)}))};return(l,t)=>{const o=(0,a.up)("arrow-down"),u=(0,a.up)("el-icon"),c=(0,a.up)("el-dropdown-item"),m=(0,a.up)("el-dropdown-menu");var p=(0,a.up)("el-dropdown");return(0,a.wg)(),(0,a.j4)(p,{trigger:"click",onCommand:s,onVisibleChange:r},{dropdown:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d,(e=>((0,a.wg)(),(0,a.j4)(c,{key:e.command,command:e.command},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.label),1)])),_:2},1032,["command"])))),128))])),_:1})])),default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Uk)((0,n.zw)(e.title)+" ",1),(0,a.Wm)(u,{class:"el-icon--right"},{default:(0,a.w5)((()=>[(0,a.Wm)(o)])),_:1})])])),_:1})}}};var d=(0,t(40089).Z)(l,[["__scopeId","data-v-5352b84c"]])}}]);