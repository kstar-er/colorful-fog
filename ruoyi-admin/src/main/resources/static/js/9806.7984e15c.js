"use strict";(self.webpackChunksystem=self.webpackChunksystem||[]).push([[9806],{51881:function(e,t){t.Z={name:"",key:"",policy:"eyJleHBpcmF0aW9uIjoiMzAyMi0wMS0wMVQxMjowMDowMC4wMDBaIiwiY29uZGl0aW9ucyI6W1siY29udGVudC1sZW5ndGgtcmFuZ2UiLDAsMTA0ODU3NjAwMF1dfQ==",OSSAccessKeyId:"LTAI5t7u1jzmji9stQ5LzCpe",success_action_status:"200",signature:"tF/dwb/qvoQjHffu0kq5FWQq9KY="}},18457:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}}),a(57658);var l=a(73396),n=a(44870),i=a(87139),r=a(44385),s=a(6094),u=a(83762),o=a(12862),d=a(81081);class m extends a(20566).Z{constructor({modules:e="",selectUri:t="/",deleteUri:a="/",selectOneUri:l="/",pageSize:n=20,tableHeader:i}={}){super({modules:e,selectUri:t,deleteUri:a,selectOneUri:l,pageSize:n,tableHeader:i})}forMatData(e,t){switch(e){case"menuType":return{M:"目录",C:"菜单",F:"按钮"}[t];case"isCache":return+t?"不缓存":"缓存";case"isFrame":return+t?"否":"是";case"visible":return+t?"隐藏":"显示";default:return t&&0<t.toString().length||"number"==typeof t?t:"-"}}createTreeData(e){let t=[];return e.forEach((a=>{var l;a.label=a.menuName,a.value=a.menuId,t.push((l=a,e.forEach((e=>{e.parentId===l.menuId&&l.children.push(e)})),l))})),t.filter((e=>0===e.parentId))}async initData(e=this,t){var{data:a,code:l}=(await d.K.post(`${e.selectUri}?pageNum=${e.currentPage}&pageSize=`+e.pageSize,e.searchData))["data"];200===l&&(e.total=a.length,e.tableData.length=0,e.noHandleData=a,e.tableData.push(...e.createTreeData(a)),t?.clearSelection())}async addMenu(e){var{code:e,data:t,msg:a}=(await d.K.post("/system/menu",e))["data"];return 200===e?{code:e,data:t}:a}async updateMenu(e){var{code:e,data:t,msg:a}=(await d.K.put("/system/menu",e))["data"];return 200===e?{code:e,data:t}:a}async getMenuInfo(e){var{code:e,data:t,msg:a}=(await d.K.get("/system/menu/"+e))["data"];return 200===e?{code:e,data:t}:a}async deleteMenu(e){var{code:e,data:t,msg:a}=(await d.K.delete("/system/menu/"+e))["data"];return 200===e?{code:e,data:t}:a}}var c=a(82261),p=a(59971),f=a(51881);const g={class:"data-filter"},v={class:"extend-handle"},h={class:"extend-handle-left"},y=["id"],b={class:"flex-center ml10"},w=(e=>((0,l.dD)("data-v-570d5458"),e=e(),(0,l.Cn)(),e))((()=>(0,l._)("span",{style:{"font-size":"14px","font-weight":"500",color:"#606266"}},"权限类型:",-1)));t={__name:"menuManagement",setup(e){const t=(0,l.Q2)("authority"),a=(0,n.iH)(f.Z),k=(0,l.FN)()["proxy"],S=(0,n.iH)(!1),C=(0,n.iH)(null),D=async()=>{C.value=new m({modules:"menu",selectUri:"/system/menu/list"}),C.value.initTableHeader(),await C.value.initData(this,k.$refs.table)},I=((0,l.wF)((()=>{D()})),async({menuId:e})=>{e=await C.value.getMenuInfo(e),200===e.code&&(x.value={...e.data},W(x.value.menuType),H.value=x.value.menuType,M.formSelectEl[0].options=[M.formSelectEl[0].options[0]],M.formSelectEl[0].options.push(...C.value.tableData)),M.isShow=!0}),E=async()=>{W(H.value),M.formSelectEl[0].options=[M.formSelectEl[0].options[0]],M.formSelectEl[0].options.push(...C.value.tableData),x.value={parentId:0,orderNum:0,isFrame:"1",status:"0",visible:"0",isCache:"0",icon:"#"},M.isShow=!0},_=async({menuId:e,path:t,perms:a})=>{W(H.value),M.formSelectEl[0].options=[M.formSelectEl[0].options[0]],M.formSelectEl[0].options.push(...C.value.tableData),x.value={parentId:e,orderNum:0,isFrame:"1",isCache:"0",status:"0",visible:"0",perms:a||t},M.isShow=!0},U=e=>{C.value.search(e,this,k.$refs.table)},T=e=>"F"===e.menuType?[(0,l.h)("div",{class:"table-handel-div"},[(0,l.wy)((0,l.h)(c.ElButton,{class:"hover-animation",onClick:()=>{I(e)},title:"编辑",type:"primary",icon:"Edit",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>""}),[[t,"system:menu:edit"]])])]:[(0,l.h)("div",{class:"table-handel-div"},[(0,l.wy)((0,l.h)(c.ElButton,{class:"hover-animation",onClick:()=>{I(e)},title:"编辑",type:"primary",icon:"Edit",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>""}),[[t,"system:menu:edit"]]),(0,l.wy)((0,l.h)(c.ElButton,{class:"hover-animation",onClick:()=>{_(e)},title:"在当前目录新增",type:"warning",icon:"CirclePlus",text:!0,style:"padding:0;margin:0;background:transparent"},{default:()=>""}),[[t,"system:menu:edit"]])])],x=(0,n.iH)({}),H=(0,n.iH)("M"),M=(0,n.qj)({isShow:!1,formInputEl:[],formSelectEl:[{title:"所属上级",key:"parentId",element:"selectTree",options:[{value:0,label:"顶级目录",children:[]}]},{title:"显示状态",key:"visible",element:"radio",options:[{label:"显示",value:"0"},{label:"隐藏",value:"1"}]},{title:"状态",key:"status",element:"radio",options:[{label:"正常",value:"0"},{label:"停用",value:"1"}]}],formTextAreaEl:[{title:"备注",key:"remark",element:"input",type:"textarea"}],formTimeAndNumber:[{title:"显示顺序",key:"orderNum",element:"number",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}],emitOpenDialog:e=>{},inputDone:async e=>{e={...e},e.menuType=H.value,e.menuId?200===(await C.value.updateMenu(e)).code&&(k.$message.success("更新成功"),C.value.initData(this,k.$refs.table),M.isShow=!1):200===(await C.value.addMenu(e)).code&&(k.$message.success("新增成功"),C.value.initData(this,k.$refs.table),M.isShow=!1)}}),W=e=>{k.$refs.dialogForm?.successSubmit(),"C"===e&&(M.formInputEl=[{title:"菜单名称",key:"menuName",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"路由地址",key:"path",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}],illustrate:"无需拼接'/', 单一字符串即可"},{title:"权限字符",key:"perms",element:"input",illustrate:"如果是顶级目录，权限标识格式: test; 如果不是，权限标识格式: test:test1:test2"},{title:"组件地址",key:"component",element:"input",illustrate:"默认在根目录下, 假设根目录为sys, 填写的地址为: '/views/test', 则表示的组件为: sys/views/test.vue"},{title:"菜单图标",key:"icon",element:"input",illustrate:"目录图标请用element里面支持的Icon图标, 大写字母开头, 非顶级菜单不显示图标"},{title:"启用缓存",key:"isCache",element:"radio",options:[{label:"是",value:"0"},{label:"否",value:"1"}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"是否外链",key:"isFrame",element:"radio",options:[{label:"是",value:"0"},{label:"否",value:"1"}],rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}]),"F"===e&&(M.formInputEl=[{title:"文案标识",key:"menuName",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"权限标识",key:"perms",element:"input",illustrate:"如果是顶级目录，权限标识格式: test; 如果不是，权限标识格式: test:test1:test2"}]),"M"===e&&(M.formInputEl=[{title:"目录名称",key:"menuName",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]},{title:"权限标识",key:"perms",element:"input",illustrate:"如果是顶级目录，权限标识格式: test; 如果不是，权限标识格式: test:test1:test2"},{title:"目录图标",key:"icon",element:"input",illustrate:"目录图标请用element里面支持的Icon图标, 大写字母开头"},{title:"路由地址",key:"path",element:"input",rules:[{required:!0,message:"该项不能为空",trigger:"blur"}]}])},F=e=>{let t=0;for(;;){let a=C.value.noHandleData.findIndex((t=>t.menuId===e.menuId));if(-1===a||0===C.value.noHandleData[a].parentId)return t;if(t++,!(e=C.value.noHandleData.find((e=>e.menuId===C.value.noHandleData[a].parentId))))return t}},z=({forMatValue:e,column:t,rowData:a})=>"menuType"===t.key?[(0,l.h)(p.Ks,{type:"M"===a[t.key]?"":"C"===a[t.key]?"success":"danger"},{default:()=>e})]:"perms"!==t.key||0===a.parentId?e:[(0,l.h)("div",{style:`padding-left:${10*F(a)}px`},e)],V=()=>{k.$refs.table.closeTree()};return(e,t)=>{const m=(0,l.up)("CircleCloseFilled"),p=(0,l.up)("el-icon");var f=(0,l.up)("el-drawer");const D=(0,l.up)("el-radio"),_=(0,l.up)("el-radio-group");var F=(0,l.Q2)("authorityHandle");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",g,[(0,l.Wm)(o.Z,{"filter-items":C.value.tableHeader,onSearch:U},null,8,["filter-items"])]),(0,l._)("div",v,[(0,l._)("div",h,[(0,l.Wm)((0,n.SU)(c.ElButton),{class:"handle-btn",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:V},{default:(0,l.w5)((()=>[(0,l.Uk)(" 全部折叠 ")])),_:1}),(0,l.wy)(((0,l.wg)(),(0,l.j4)((0,n.SU)(c.ElButton),{class:"handle-btn",color:"#4a78bd",style:{color:"#666"},plain:"",onClick:E},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增 ")])),_:1})),[[F,"system:menu:add"]])])]),(0,l.Wm)(u.Z,{ref:"table","need-end-handle":"","need-check-box":!1,"need-customize-cell-renderer":"","need-expand":"","row-key":"menuId","need-pagination":!1,total:C.value.total,"current-page":C.value.currentPage,"page-size":C.value.pageSize,"table-data":C.value.tableData,columns:C.value.tableHeader,loading:(0,n.SU)(d.V)&&!M.isShow,"default-end-handle":!1,"customize-end-handle":T,"for-mat-data":C.value.forMatData,"customize-cell-renderer":z,"end-handle-width":140,onSelectionChange:t[0]||(t[0]=e=>C.value.selectionChange(e,C.value,(0,n.SU)(k).$refs.table)),onRefresh:t[1]||(t[1]=e=>C.value.initData(C.value,(0,n.SU)(k).$refs.table)),onEditRow:I,onCurrentChange:t[2]||(t[2]=e=>C.value.currentPageChange(e,C.value,(0,n.SU)(k).$refs.table)),onSizeChange:t[3]||(t[3]=e=>C.value.pageSizeChange(e,C.value,(0,n.SU)(k).$refs.table)),onEditTableHeader:t[4]||(t[4]=e=>S.value=!0)},null,8,["total","current-page","page-size","table-data","columns","loading","for-mat-data"]),(0,l.Wm)(f,{modelValue:S.value,"onUpdate:modelValue":t[6]||(t[6]=e=>S.value=e),"show-close":!1},{header:(0,l.w5)((({titleId:e,titleClass:a})=>[(0,l._)("h4",{id:e,class:(0,i.C_)(a)}," 通过拖拽设置您喜欢的表头顺序 ",10,y),(0,l.Wm)((0,n.SU)(c.ElButton),{type:"danger",onClick:t[5]||(t[5]=e=>S.value=!1)},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{class:"el-icon--left"},{default:(0,l.w5)((()=>[(0,l.Wm)(m)])),_:1}),(0,l.Uk)(" 关闭 ")])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(s.Z,{"is-show-edit-table-header":S.value,modules:"menu"},null,8,["is-show-edit-table-header"])])])),_:1},8,["modelValue"]),M.isShow?((0,l.wg)(),(0,l.j4)(r.Z,{key:0,ref:"dialogForm",width:"60%",loading:(0,n.SU)(d.V),"my-client":a.value,"form-data":x.value,"is-show":M.isShow,title:"请填写相关信息","form-input-el":M.formInputEl,"form-select-el":M.formSelectEl,"form-text-area-el":M.formTextAreaEl,"form-upload-el":M.formUploadEl,"form-time-and-number":M.formTimeAndNumber,onCloseDialog:t[8]||(t[8]=e=>M.isShow=!1),onEmitOpenDialog:M.emitOpenDialog,onInputDone:M.inputDone},{customOperation:(0,l.w5)((()=>[(0,l._)("div",b,[w,(0,l.Wm)(_,{modelValue:H.value,"onUpdate:modelValue":t[7]||(t[7]=e=>H.value=e),class:"ml10",disabled:!!x.value.menuId,onChange:W},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"M"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 目录 ")])),_:1}),(0,l.Wm)(D,{label:"C"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 菜单 ")])),_:1}),(0,l.Wm)(D,{label:"F"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 按钮 ")])),_:1})])),_:1},8,["modelValue","disabled"])])])),_:1},8,["loading","my-client","form-data","is-show","form-input-el","form-select-el","form-text-area-el","form-upload-el","form-time-and-number","onEmitOpenDialog","onInputDone"])):(0,l.kq)("",!0)])}}};var k=(0,a(40089).Z)(t,[["__scopeId","data-v-570d5458"]])},6094:function(e,t,a){a.d(t,{Z:function(){return p}}),a(57658);var l=a(73396),n=a(44870),i=a(49242),r=a(87139),s=a(98249),u=a(40130),o=a(46623);const d={class:"container"},m={class:"drag-box"},c={class:"drag-btn"};t={__name:"dynamicHeader",props:{isShowEditTableHeader:{type:Boolean,default:!1},modules:{type:String,default:""},filterList:{type:Array,default:()=>[]}},emits:["updateCompleted"],setup(e,{emit:t}){const a=e,{_state:p,commit:f}=(0,o.oR)(),g=p.data[a.modules].defaultTableHeader,v=(0,n.qj)([]),h=(0,n.iH)(!1),y=((0,l.wF)((()=>{(v.length=0)===a.filterList.length?v.push(...p.data[a.modules].tableHeader):p.data[a.modules].tableHeader.forEach((e=>{a.filterList.includes(e.key)||v.push(e)}))})),e=>{h.value=!1}),b=()=>{u.T.confirm("重置之后保存的数据将会丢失，是否继续？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{v.length=0,v.push(...JSON.parse(JSON.stringify(g))),f(a.modules+"/updateTableHeader",v),u.T.alert("修改成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{t("updateCompleted"),location.reload()}}),t("updateCompleted")})).catch((()=>{}))},w=()=>{u.T.confirm("确认保存？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((()=>{0!==a.filterList.length&&p.data[a.modules].tableHeader.forEach((e=>{a.filterList.includes(e.key)&&v.push(e)})),f(a.modules+"/updateTableHeader",v),u.T.alert("设置成功！刷新后生效","提示",{type:"warning",icon:"InfoFilled",confirmButtonText:"立即刷新",callback:e=>{t("updateCompleted"),location.reload()}})})).catch((()=>{}))};return(e,t)=>{const a=(0,l.up)("el-tag"),u=(0,l.up)("el-checkbox");var o=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",m,[(0,l.Wm)((0,n.SU)(s.J),{list:v,"chosen-class":"chosen",group:"name","force-fallback":"true",animation:"500","fallback-tolerance":4,onStart:t[0]||(t[0]=e=>h.value=!0),onEnd:y},{default:(0,l.w5)((()=>[(0,l.Wm)(i.W3,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(v,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.key||e.prop,class:"item"},[(0,l.Wm)(a,{size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.title||e.label),1)])),_:2},1024),(0,l._)("div",null,[(0,l.Wm)(u,{modelValue:e.isFixed,"onUpdate:modelValue":t=>e.isFixed=t,label:"固定在左边",size:"large"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(u,{modelValue:e.isShow,"onUpdate:modelValue":t=>e.isShow=t,label:"是否展示",size:"large"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])),_:1})])),_:1},8,["list"])]),(0,l._)("div",c,[(0,l.Wm)(o,{type:"warning",onClick:b},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1}),(0,l.Wm)(o,{type:"primary",onClick:w},{default:(0,l.w5)((()=>[(0,l.Uk)(" 保存 ")])),_:1})])])}}};var p=(0,a(40089).Z)(t,[["__scopeId","data-v-4c5f22fa"]])}}]);